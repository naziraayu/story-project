const CACHE_NAME="story-app-cache-v1",STATIC_ASSETS=["/","/index.html","/favicon.ico","/manifest.json","/app.js","/styles/main.css","/scripts/views/favorite.js","/scripts/presenter/favorite-presenter.js","/scripts/utils/favorite-db.js","/app.bundle.js"];self.addEventListener("install",(e=>{e.waitUntil(caches.open(CACHE_NAME).then((e=>e.addAll(FILES_TO_CACHE))).catch((e=>{console.error("Cache addAll failed:",e)})))})),self.addEventListener("fetch",(e=>{e.respondWith(caches.match(e.request).then((t=>t||fetch(e.request))).catch((()=>{if("navigate"===e.request.mode)return caches.match("/offline.html")})))})),self.addEventListener("activate",(e=>{e.waitUntil(caches.keys().then((e=>Promise.all(e.filter((e=>e!==CACHE_NAME)).map((e=>caches.delete(e))))))),clients.claim()})),self.addEventListener("push",(function(e){console.log("[Service Worker] Push Received");let t="New Story has been added!";try{e.data&&(t=e.data.text(),console.log("[Service Worker] Push message data:",t))}catch(e){console.error("[Service Worker] Error parsing push data:",e)}e.waitUntil(self.registration.showNotification("ðŸ“¢ Story App",{body:t,icon:"/icons/icon-192.png",badge:"/icons/icon-192.png",requireInteraction:!0}))})),self.addEventListener("message",(e=>{console.log("[Service Worker] Message received:",e.data),e.data&&"SHOW_NOTIFICATION"===e.data.type&&self.registration.showNotification(e.data.title||"Story App",{body:e.data.body||"Notification from Story App",icon:"/icons/icon-192.png",requireInteraction:e.data.requireInteraction||!1})})),self.addEventListener("notificationclick",(function(e){console.log("[Service Worker] Notification click received"),e.notification.close(),e.waitUntil(clients.matchAll({type:"window"}).then((function(e){for(let t=0;t<e.length;t++){const i=e[t];if("/"===i.url&&"focus"in i)return i.focus()}if(clients.openWindow)return clients.openWindow("/")})))}));